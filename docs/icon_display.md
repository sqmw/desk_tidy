# 图标显示问题

## 背景
早期版本中，`cursor-freevipxxx` 显示全称后鼠标离开其他应用仍然残留图标，给人“失去焦点也不恢复”的错觉；后来又发现图标、应用与文件之间的显示高度不一致，长名称的文件显得很突兀。

## 目标
1. 保证图标刷新后与桌面实际一致（包括隐藏/显示状态）。  
2. 避免图标的扩展名/类型判别失效（例如 `.lnk`、实际路径）。  
3. 当图标/应用展示在窗口中时和系统桌面保持一致的视觉层级与尺寸。

## 解决策略
1. **可靠采集**  
   - 扫描桌面路径时先使用 Windows API（`Shell32`）枚举 `.lnk` 以及文件夹、文件，结果写入 `ShortcutItem`。  
   - 过滤掉指向文件夹的 `.lnk`，单独由“文件夹”标签处理，避免重复。  
   - 对于没有图标的情况，尝试从快捷方式对应目标或目标文件提取图标，失败时保持占位。  
2. **刷新与同步**  
   - 使用 `Timer.periodic` 轮询 `isDesktopIconsVisible()` 与实际系统状态；当用户在系统设置里显示/隐藏桌面图标，本应用通过 `_hideDesktopItems` 同步并保存偏好。  
   - 新增 `findMainFlutterWindowHandle()` 和 `isCursorOverWindowHandle()`，在自动隐藏时能用原生 HWND 判定鼠标是否在窗口内（避免 DPI/坐标不一致导致的误判）。  
3. **UI 统一**  
   - 所有快捷入口统一在 `ShortcutCard` 中展示图标、文字、阴影与尺寸。  
   - 多处使用 `GlassContainer` 与 `NavigationRail` 等控件保持一致的边框与模糊，确保图标高度、边距统一。  

如需扩展其他图标相关行为，可在此文档基础上补充。

