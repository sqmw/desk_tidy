# 文件管理功能集成方案 (File Management Features)

本方案实现了核心文件管理交互，增强了与 Windows 系统的原生联动。

## 1. 核心功能

### 1.1 新建文件夹 (New Folder)
- **底层实现**: `DesktopHelper.createNewFolder` 方法实现了带冲突检查的创建逻辑。
- **自动命名**: 当目标位置已存在同名文件夹时，会自动生成 `新建文件夹 (2)`、`新建文件夹 (3)` 等唯一名称。
- **入口**: 
    - “全部”标签页根目录：点击空白处，在系统桌面上新建。
    - 文件夹视图：点击空白处，在当前文件夹内新建。

### 1.2 在文件资源管理器中中显示 (Show in Explorer)
- **底层实现**: `DesktopHelper.showInExplorer` 调用 `explorer.exe /select,"path"`。
- **效果**: 打开该项目所在的父文件夹，并自动高亮选中该项目。
- **兼容性**: 
    - 支持普通文件、文件夹和桌面快捷方式。
    - 系统项（如回收站、此电脑）不显示此选项（因其本身即为虚拟路径）。

## 2. 右键菜单优化 (Context Menu Refinement)
统一了全平台的右键菜单排序，遵循 Windows 用户的操作直觉：
1. **打开 (Open)** - 最常用操作。
2. **使用其他应用打开 (Open With)** - 仅文件。
3. **在文件资源管理器中显示 (Show in Explorer)** - 定位文件。
4. --- 分割线 ---
5. **添加到分类 / 移动 / 复制** - 组织操作。
6. **重命名 / 删除** - 维护操作。
7. --- 分割线 ---
8. **复制名称 / 路径 / 所在文件夹** - 信息获取。

## 3. 页面内交互
- **空白处点击**: 在 `GridView` 上通过 `GestureDetector` 捕获 `onSecondaryTapDown`，确保用户可以随时通过右键刷新页面或新建内容。
- **粘贴支持**: 在空白处右键菜单中集成了“粘贴”功能，方便快速从剪贴板导入文件。

## 4. 修改记录
- **2026-01-24**: 
    - 实现 `DesktopHelper` 文件夹管理封装。
    - 集成全页面右键菜单联动。
    - 优化菜单项顺序。
