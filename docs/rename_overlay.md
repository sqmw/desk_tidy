# 浮动重命名 Overlay (气泡风格)

## 功能概述
使用**漫画气泡风格**的浮动输入框替代原有的模态弹窗。气泡始终优先指向**目标文件本身**，提供“所指即所得”的直观交互体验。

## 视觉与交互

### 气泡样式 (Bubble)
- **形状**：圆角矩形背景，带有指向性小箭头。
- **定位原则**：始终**优先指向文件列表项**（RenderBox）。
- **自适应**：如果不具备上方显示空间，自动切换到下方显示，箭头方向随之反转。

### 统一的定位逻辑
无论触发方式如何，定位逻辑始终一致：
1. **优先**：通过 `GlobalObjectKey` 寻找文件列表项的精确位置。
   - **效果**：气泡精准悬浮在文件名上方/下方，箭头指向文件。
2. **次选**：如果列表项不可见（例如未渲染），使用**备用锚点**（如鼠标点击位置）。
3. **兜底**：如果以上皆不可用，显示在屏幕中央。

### 触发方式
| 方式 | 行为 |
|------|------|
| **F2 快捷键** | 指向选中文件。 |
| **右键 "重命名"** | 指向右键点击的文件（即使鼠标移开，气泡依然指向文件）。 |

## 交互操作
| 动作 | 效果 |
|------|------|
| **Enter** | 提交保存 |
| **ESC** | 取消编辑 |
| **小图标 ✓** | 提交保存 |
| **小图标 ✗** | 取消编辑 |
| **点击外部** | 取消编辑 |

## 技术实现
- **GlobalObjectKey**: 为每个列表项分配唯一 Key (`entity.path`)，用于随时获取其 Context 和 RenderBox。
- **CustomPaint**: 使用自定义 `_BubblePainter` 绘制动态箭头背景。
